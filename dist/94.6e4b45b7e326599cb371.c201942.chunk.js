(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{"27305ba73766273c92d0":function(e,t,n){"use strict";n.r(t);var a,r=n("8af190b70a6bc55c6f1b"),o=n.n(r),i=n("8a2d1b95e05b6a321e74"),s=n.n(i),c=n("d7dd51e1bf6bfc2c9c3d"),d=n("0d7f0986bcd2f33d8a2a"),f=n.n(d),u=n("1dfca9f44be16af281fa"),l=n("54f683fcda7806277002"),p=n("47e94b5ec55a17ebe237"),b=n("86b83146d2366c27fd7c"),m=n("a0eea3e3c7c0b7b70771"),y=n("02787f146ca448ef9310"),h=n("fcb99a06256635f70435"),g=n("2157bd598f2b425595ea"),v=n("52147c536625ee918894"),O=n("a72b40110d9c31c9b5c5"),j=n("6542cd13fd5dd1bcffd4"),w=n("fb88414ab887e57c7b57"),M=n("17a826745d7905c7f263"),S=n("4bbbd76528501909b843"),x=n("e4dd33cd8c3dbbd378c3"),C=n("2da65066c2da9f64c68a"),T=n("0d5a1aa701766449187d"),N=n("84172d867dd512924df2"),E=n("ab039aecd4a1d4fedc0e"),R=Object(E.defineMessages)({pageTitle:{id:"app.containers.CategoryNew.pageTitle",defaultMessage:"New category"},pageTitleTaxonomy:{id:"app.containers.CategoryNew.pageTitleTaxonomy",defaultMessage:"New {taxonomy}"},metaDescription:{id:"app.containers.CategoryNew.metaDescription",defaultMessage:"New Category page description"},header:{id:"app.containers.CategoryNew.header",defaultMessage:"New Category"}}),F=n("a43417795db36d1bd03a");function _(e){return(_="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t,n,r){a||(a="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var s=new Array(i),c=0;c<i;c++)s[c]=arguments[c+3];t.children=s}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:a,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function I(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=B(e);if(t){var r=B(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}(this,n)}}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"CategoryNew",function(){return H});var U=D(M.a,{}),H=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(i,o.a.PureComponent);var t,n,a,r=A(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),J(k(t=r.call(this,e)),"getHeaderMainFields",function(){var e=t.context.intl,n=[];return n.push({fields:[Object(p.z)(e.formatMessage),Object(p.w)(e.formatMessage)]}),n}),J(k(t),"getHeaderAsideFields",function(e,n,a){var r=t.context.intl,o=[];return o.push({fields:[Object(p.x)(r.formatMessage)]}),e.getIn(["attributes","tags_users"])&&o.push({fields:[Object(p.d)(r.formatMessage,"user_only")]}),n&&a&&o.push({label:r.formatMessage(v.a.entities.taxonomies.parent),icon:"categories",fields:[Object(p.J)(n,Object(T.y)(a))]}),o}),J(k(t),"getBodyMainFields",function(){var e=t.context.intl,n=[];return n.push({fields:[Object(p.m)(e.formatMessage)]}),n}),J(k(t),"getBodyAsideFields",function(){var e=t.context.intl,n=[];return n.push({fields:[Object(p.j)({formatMessage:e.formatMessage,controlType:"url",attribute:"url"})]}),n}),J(k(t),"getTaxTitle",function(e){return t.context.intl.formatMessage(v.a.entities.taxonomies[e].single)}),t.scrollContainer=o.a.createRef(),t}return t=i,(n=[{key:"UNSAFE_componentWillMount",value:function(){this.props.loadEntitiesIfNeeded(),this.props.initialiseForm("categoryNew.form.data",F.b)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.dataReady||this.props.loadEntitiesIfNeeded(),e.authReady&&!this.props.authReady&&this.props.redirectIfNotPermitted(),Object(m.a)(e,this.props)&&this.scrollContainer&&Object(b.d)(this.scrollContainer.current)}},{key:"render",value:function(){var e=this,t=this.context.intl,n=this.props,a=n.taxonomy,r=n.dataReady,i=n.viewDomain,s=n.parentOptions,c=n.parentTaxonomy,d=i.get("page").toJS(),u=d.saveSending,l=d.saveError,p=d.submitValid,b=this.props.params.id,m=t.formatMessage(R.pageTitle);return a&&a.get("attributes")&&(m=t.formatMessage(R.pageTitleTaxonomy,{taxonomy:this.getTaxTitle(a.get("id"))})),D("div",{},void 0,D(f.a,{title:t.formatMessage(R.pageTitle),meta:[{name:"description",content:t.formatMessage(R.metaDescription)}]}),o.a.createElement(S.a,{ref:this.scrollContainer},D(x.a,{title:m,type:h.l,icon:"categories",buttons:r?[{type:"cancel",onClick:function(){return e.props.handleCancel(b)}},{type:"save",disabled:u,onClick:function(){return e.props.handleSubmitRemote("categoryNew.form.data")}}]:null}),!p&&D(w.a,{type:"error",messageKey:"submitInvalid",onDismiss:this.props.onErrorDismiss}),l&&D(w.a,{type:"error",messages:l.messages,onDismiss:this.props.onServerErrorDismiss}),(u||!r)&&U,r&&D(C.a,{model:"categoryNew.form.data",formData:i.getIn(["form","data"]),saving:u,handleSubmit:function(t){return e.props.handleSubmit(t,a)},handleSubmitFail:this.props.handleSubmitFail,handleCancel:function(){return e.props.handleCancel(b)},handleUpdate:this.props.handleUpdate,fields:{header:{main:this.getHeaderMainFields(),aside:this.getHeaderAsideFields(a,s,c)},body:{main:this.getBodyMainFields(),aside:this.getBodyAsideFields()}},scrollContainer:this.scrollContainer.current})))}}])&&I(t.prototype,n),a&&I(t,a),i}();H.contextTypes={intl:s.a.object.isRequired};t.default=Object(c.connect)(function(e,t){return{isAdmin:Object(j.vb)(e),viewDomain:Object(N.a)(e),dataReady:Object(j.Pb)(e,{path:F.a}),authReady:Object(j.Qb)(e),taxonomy:Object(j.qc)(e,t.params.id),parentOptions:Object(N.b)(e,t.params.id),parentTaxonomy:Object(N.c)(e,t.params.id)}},function(e){return{initialiseForm:function(t,n){e(u.actions.reset(t)),e(u.actions.change(t,n))},loadEntitiesIfNeeded:function(){F.a.forEach(function(t){return e(Object(O.s)(t))})},redirectIfNotPermitted:function(){e(Object(O.A)(g.M.MANAGER.value))},onErrorDismiss:function(){e(Object(O.Y)(!0))},onServerErrorDismiss:function(){e(Object(O.F)())},handleSubmitFail:function(){e(Object(O.Y)(!1))},handleSubmitRemote:function(t){e(u.actions.submit(t))},handleSubmit:function(t,n){var a,r=t.setIn(["attributes","taxonomy_id"],n.get("id")),o=Object(y.c)(t.get("associatedCategory"));r=l.List.isList(o)&&o.size?r.setIn(["attributes","parent_id"],o.first()):r.setIn(["attributes","parent_id"],null),e((a=r.toJS(),{type:F.c,data:a}))},handleCancel:function(t){e(Object(O.cb)("".concat(g.I.TAXONOMIES,"/").concat(t),{replace:!0}))},handleUpdate:function(t){e(Object(O.bb)(t))},onCreateOption:function(t){e(Object(O.y)(t))}}})(H)}}]);